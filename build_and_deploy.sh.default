#! /bin/bash
 
if [ "$1" = "rb-control" ]; then
    rm -rf target/armv7-unknown*
    CARGO_TARGET_ARMV7_UNKNOWN_LINUX_GNUEABI_RUSTFLAGS="-C relocation-model=dynamic-no-pic -C target-feature=+crt-static" \
    cross build --release --bin rb-control --target=armv7-unknown-linux-musleabi
    scp target/armv7-unknown-linux-musleabi/release/rb-control tof-rb##:~/bin
elif [ "$1" = "pb-control" ]; then
    rm -rf target/armv7-unknown*
    CARGO_TARGET_ARMV7_UNKNOWN_LINUX_GNUEABI_RUSTFLAGS="-C relocation-model=dynamic-no-pic -C target-feature=+crt-static" \
    cross build --release --bin pb-control --target=armv7-unknown-linux-musleabi
    scp target/armv7-unknown-linux-musleabi/release/pb-control tof-rb##:~/bin
elif [ "$1" = "cpu-control" ]; then
    rm -rf target/x86_64-unknown*
    CARGO_TARGET_X86_64_UNKNOWN_LINUX_MUSL_RUSTFLAGS="-C relocation-model=dynamic-no-pic -C target-feature=+crt-static" \
    cross build --release --bin cpu-control --target=x86_64-unknown-linux-musl
    scp target/x86_64-unknown-linux-musl/release/cpu-control tof-cpu:~/bin
else
    rm -rf target/armv7-unknown*
    CARGO_TARGET_ARMV7_UNKNOWN_LINUX_GNUEABI_RUSTFLAGS="-C relocation-model=dynamic-no-pic -C target-feature=+crt-static" \
    cross build --bin tof-control --target=armv7-unknown-linux-musleabi
    scp target/armv7-unknown-linux-musleabi/release/tof-control tof-rb##:~/bin
fi